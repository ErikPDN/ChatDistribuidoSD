# Chat DistribuÃ­do em Java â˜•

Este Ã© um projeto de um sistema de chat distribuÃ­do, desenvolvido em Java puro, utilizando Sockets para a comunicaÃ§Ã£o. A arquitetura segue o modelo Cliente-Servidor e permite a troca de mensagens e arquivos em tempo real entre mÃºltiplos usuÃ¡rios.

## Funcionalidades âœ¨

* **Chat em Grupo (Broadcast):** Mensagens enviadas por um usuÃ¡rio sÃ£o recebidas por todos os outros usuÃ¡rios conectados.
* **Mensagens Privadas:** Um usuÃ¡rio pode enviar uma mensagem que serÃ¡ lida apenas pelo destinatÃ¡rio especÃ­fico.
* **Envio de Arquivos Privado:** Permite que um usuÃ¡rio envie um arquivo diretamente para outro de forma segura, com um protocolo de negociaÃ§Ã£o (handshake) que exige a aceitaÃ§Ã£o do destinatÃ¡rio.
* **Compartilhamento de Arquivos em Grupo:** Um usuÃ¡rio pode fazer o upload de um arquivo para o servidor, que entÃ£o notifica a todos os outros usuÃ¡rios. Os demais podem entÃ£o baixar o arquivo individualmente.
* **NotificaÃ§Ãµes de ConexÃ£o/DesconexÃ£o:** O chat anuncia quando um novo usuÃ¡rio entra ou sai.
* **Timestamp:** Todas as mensagens exibem o horÃ¡rio em que foram enviadas, facilitando a leitura.
* **Servidor Concorrente:** O servidor utiliza um pool de threads para gerenciar mÃºltiplas conexÃµes de clientes simultaneamente.

## PrÃ©-requisitos

Para compilar e executar este projeto, vocÃª precisarÃ¡ ter instalado:

* **JDK (Java Development Kit)** - VersÃ£o 11 ou superior.

## Configurando o Cliente (`config.properties`)

Antes de executar o cliente, Ã© necessÃ¡rio informar a ele como encontrar o servidor. Isso Ã© feito atravÃ©s de um arquivo de configuraÃ§Ã£o.

1.  Crie um arquivo chamado `config.properties` na raiz do seu projeto.
2.  Adicione o seguinte conteÃºdo a ele, substituindo o IP pelo endereÃ§o da mÃ¡quina onde o servidor estÃ¡ rodando:

    ```properties
    # EndereÃ§o IP da mÃ¡quina onde o Servidor estÃ¡ rodando
    server.address=192.168.0.15

    # Porta em que o Servidor estÃ¡ escutando (deve ser a mesma do servidor)
    server.port=12345
    ```
* **Para testes locais (servidor e cliente na mesma mÃ¡quina):** use `server.address=localhost`.
* **Para conectar via rede local:** use o endereÃ§o IP da mÃ¡quina servidora (ex: `192.168.0.15`).

## Como Compilar e Executar ğŸš€

Siga os passos abaixo para colocar o chat em funcionamento.

### 1. Clone o RepositÃ³rio

Se vocÃª ainda nÃ£o o fez, clone o projeto para a sua mÃ¡quina local:
```bash
git clone <URL_DO_SEU_REPOSITORIO>
cd ChatDistribuido
```

### 2. Compile o CÃ³digo-Fonte

Use o comando `javac` para compilar todos os arquivos `.java`. O comando `-d out` criarÃ¡ um diretÃ³rio chamado `out` para armazenar os arquivos `.class` compilados.

```bash
javac -d out src/**/*.java
```
*Se o seu shell nÃ£o suportar `**`, vocÃª pode usar `find src -name "*.java" -print | xargs javac -d out`.*

### 3. Inicie o Servidor

Em um terminal, execute a classe `Server`. O servidor ficarÃ¡ ativo, aguardando conexÃµes dos clientes. **Este terminal deve permanecer aberto.**

```bash
java -cp out servidor.Server
```
VocÃª deverÃ¡ ver a mensagem: `Servidor iniciando na porta 12345. Aguardando clientes...`

### 4. Inicie os Clientes

ApÃ³s configurar o arquivo `config.properties`, para cada cliente que vocÃª quiser conectar, **abra um novo terminal** e execute o seguinte comando simples:

```bash
java -cp out client.Client
```
O cliente lerÃ¡ automaticamente as configuraÃ§Ãµes do arquivo `config.properties` para saber a qual servidor se conectar. Repita este passo para quantos clientes desejar.

## Como Usar o Chat

ApÃ³s se conectar, vocÃª verÃ¡ uma mensagem de boas-vindas.

### Comandos de Mensagem

* **Enviar mensagem para todos:** Simplesmente digite sua mensagem e pressione `Enter`.
    ```
    OlÃ¡, pessoal!
    ```
* **Enviar mensagem privada:** Use o formato `@nome_do_usuario <sua mensagem>`.
    ```
    @JoÃ£o Tudo certo para mais tarde?
    ```
* **Sair do chat:** Digite `sair` e pressione `Enter`.

### Compartilhando Arquivos ğŸ“‚

O compartilhamento de arquivos pode ser feito de duas maneiras: enviando para um Ãºnico usuÃ¡rio ou para todos.

#### 1. Envio Privado (UsuÃ¡rio para UsuÃ¡rio)

Este envio ocorre em duas etapas: a oferta e a aceitaÃ§Ã£o.

* **Para oferecer um arquivo:** Use o comando `/sendfile <destinatario> <caminho_completo_do_arquivo>`.
    * **Exemplo:** `/sendfile ana C:\Users\Erik\Documentos\trabalho.pdf`

* **Para aceitar um arquivo:** O destinatÃ¡rio receberÃ¡ uma notificaÃ§Ã£o. Para confirmar, ele deve usar o comando `/accept <remetente>`.
    * **Exemplo:** `/accept erik`

A transferÃªncia iniciarÃ¡ automaticamente entre os dois usuÃ¡rios, com o servidor atuando como intermediÃ¡rio.

#### 2. Envio para Todos (Broadcast)

Este envio ocorre em trÃªs etapas: upload, notificaÃ§Ã£o e download.

* **Passo A: O remetente envia o arquivo para o servidor.**
    Use o destinatÃ¡rio especial `@all` no comando `/sendfile`.
    * **Exemplo:** `/sendfile @all C:\Users\Erik\Documentos\anuncio.pdf`
    O arquivo serÃ¡ enviado para o servidor, que o armazenarÃ¡ temporariamente.

* **Passo B: O servidor notifica a todos.**
    Os outros usuÃ¡rios verÃ£o uma mensagem no chat:
    ```
    >>> Erik compartilhou o arquivo 'anuncio.pdf'.
    >>> Para baixar, digite: /download anuncio.pdf
    ```

* **Passo C: Outros usuÃ¡rios baixam o arquivo.**
    Qualquer usuÃ¡rio que desejar o arquivo pode usar o comando `/download <nome_do_arquivo>`.
    * **Exemplo:** `/download anuncio.pdf`

A transferÃªncia iniciarÃ¡ do servidor para o cliente. O arquivo serÃ¡ salvo em uma pasta `downloads`.

## Estrutura do Projeto

```
.
â”œâ”€â”€ out/                      # DiretÃ³rio para os arquivos .class compilados
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ cliente/
â”‚   â”‚   â””â”€â”€ Client.java       # LÃ³gica do lado do cliente
â”‚   â””â”€â”€ servidor/
â”‚       â”œâ”€â”€ Server.java            # LÃ³gica principal do servidor
â”‚       â”œâ”€â”€ ClientHandler.java     # Gerencia o chat de texto de um cliente
â”‚       â”œâ”€â”€ FileTransferHandler.java # Gerencia transferÃªncia privada (ponto-a-ponto)
â”‚       â”œâ”€â”€ FileUploadHandler.java   # Gerencia o upload de um arquivo para o servidor
â”‚       â””â”€â”€ FileDownloadHandler.java # Gerencia o download de um arquivo do servidor
â”œâ”€â”€ config.properties         # Arquivo de configuraÃ§Ã£o do cliente
â””â”€â”€ README.md
```
